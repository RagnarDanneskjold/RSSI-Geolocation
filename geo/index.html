<html>
<head>
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
<title>Google Maps - pygmaps </title>
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
<script type="text/javascript" src="maplabel-compiled.js"></script><script type="text/javascript">
	function initialize() {
		var centerlatlng = new google.maps.LatLng(46.518394, 6.568469);
		var myOptions = {
			zoom: 16,
			center: centerlatlng,
			mapTypeId: google.maps.MapTypeId.SATELLITE
		};
		var map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
 
        var ws = new WebSocket("ws://localhost:8888/ws");
		ws.onmessage = function(evt) {
			var mapLabel = new MapLabel({
					text: "Updated",
					position: new google.maps.LatLng(46.516377, 6.568549),
					map: map,
					fontSize: 12,
					align: "center"
				})
				var marker = new google.maps.Marker;
					marker.bindTo("map", mapLabel);
					marker.bindTo("position", mapLabel);
					marker.setDraggable(true);
				}
		ws.onclose = function(evt) { alert("Connection close"); };
 
          ws.onopen = function(evt) { 
				var mapLabel = new MapLabel({
					text: "Open!",
					position: new google.maps.LatLng(46.517377, 6.569549),
					map: map,
					fontSize: 12,
					align: "center"
				})
				var marker = new google.maps.Marker;
					marker.bindTo("map", mapLabel);
					marker.bindTo("position", mapLabel);
					marker.setDraggable(true);
		  }
        };


</script>
</head>
<body style="margin:0px; padding:0px;" onload="initialize()">
	<div id="map_canvas" style="width: 100%; height: 100%;"></div>
</body>
</html>
